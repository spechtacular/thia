{% extends "base.html" %}
{% load static %}
{% block title %}Prep – {{ user.get_full_name }}{% endblock %}

{% block content %}

  <div class="d-flex align-items-center mb-3">
      <div class="ratio" style="--bs-aspect-ratio: 133.333%; max-width: 320px;">
        <img src="{% static 'people_pics/' %}{{ user.image_url }}"
            class="w-100 h-100 rounded-2 object-fit-cover"
            alt="Profile Picture">
      </div>
  </div>
  <p><strong class="me-3"> {{ user.get_full_name }} </strong></p>
  <p><strong>Prep for Event: {{ event.event_name }}</strong></p>
  <p><strong>Event Date:</strong> {{ event.event_date|date:"d-m-Y" }}</p>
  <p>
    <strong>Task:</strong> {{ ev_signup.task|default:"None" }}
    <strong>Slot Column:</strong> {{ ev_signup.slot_column|default:"None" }}
    &nbsp;|&nbsp;
    <strong>Slot Row:</strong> {{ ev_signup.slot_row|default:"None" }}
  </p>
  <p>
    <strong>Volunteer Slot:</strong>
    Start: {{ ev_signup.start_time|date:"H:i" }},
    End:   {{ ev_signup.end_time|date:"H:i" }}
  </p>

  <hr>

  <h2>Volunteer Prep Info</h2>
  <ul class="list-unstyled mb-4">
    <li><strong>Phone:</strong> {{ ev_signup.phone1 }}{% if user.phone2 %} / {{ user.phone2 }}{% endif %}</li>
    <li><strong>ICE Contact:</strong> {{ ev_signup.ice_name }} ({{ ev_signup.ice_relationship }}) – {{ ev_signup.ice_phone }}</li>
    <li><strong>Allergies:</strong> {{ ev_signup.allergies|default:"None" }}</li>
    <li><strong>Date of birth:</strong> {{ ev_signup.date_of_birth|date:"d-m-Y"}},
    <strong>Under 16:</strong> {{ ev_signup.under_16|yesno:"Yes,No" }},
    <strong>Under 18:</strong> {{ ev_signup.under_18|yesno:"Yes,No" }}</li>
  </ul>

  <h3>Update Prep Status</h3>
  <form method="post" class="mb-4">
    {% csrf_token %}
    <div class="row">
      {% for field in form %}
        <div class="col-md-3 form-check mb-2">
          {{ field }}
          <label class="form-check-label" for="{{ field.id_for_label }}">
            {{ field.label }}
          </label>
        </div>
      {% endfor %}
    </div>
    <button type="submit" class="btn btn-primary">Save Prep Status</button>
  </form>

  <p><a href="{% url 'event_detail' event.pk %}">&laquo; Back to Event Detail</a></p>
{% endblock %}
